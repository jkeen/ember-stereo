{"version":3,"file":"mime-types.js","sources":["../../../src/-private/utils/mime-types.js"],"sourcesContent":["// we are only concerned with a subset of all available mime types\n// data and function lifted from https://github.com/jshttp/mime-db\nconst MIME_TYPES = {\n  'audio/3gpp': {\n    source: 'iana',\n    extensions: ['3gpp'],\n  },\n  'audio/adpcm': {\n    source: 'apache',\n    extensions: ['adp'],\n  },\n  'audio/aac': {\n    compressible: false,\n    extensions: ['aac'],\n  },\n  'audio/basic': {\n    source: 'iana',\n    compressible: false,\n    extensions: ['au', 'snd'],\n  },\n  'audio/midi': {\n    source: 'apache',\n    extensions: ['mid', 'midi', 'kar', 'rmi'],\n  },\n  'audio/mp3': {\n    compressible: false,\n    extensions: ['mp3'],\n  },\n  'audio/mp4': {\n    source: 'iana',\n    compressible: false,\n    extensions: ['m4a', 'mp4a'],\n  },\n  'audio/mpeg': {\n    source: 'iana',\n    compressible: false,\n    extensions: ['mpga', 'mp2', 'mp2a', 'mp3', 'm2a', 'm3a'],\n  },\n  'audio/ogg': {\n    source: 'iana',\n    compressible: false,\n    extensions: ['oga', 'ogg', 'spx', 'opus'],\n  },\n  'audio/opus': {},\n  'audio/flac': {\n    source: 'iana',\n    extensions: ['flac'],\n  },\n  'audio/s3m': {\n    source: 'apache',\n    extensions: ['s3m'],\n  },\n  'audio/silk': {\n    source: 'apache',\n    extensions: ['sil'],\n  },\n  'audio/vnd.dece.audio': {\n    source: 'iana',\n    extensions: ['uva', 'uvva'],\n  },\n  'audio/vnd.digital-winds': {\n    source: 'iana',\n    extensions: ['eol'],\n  },\n  'audio/vnd.dra': {\n    source: 'iana',\n    extensions: ['dra'],\n  },\n  'audio/vnd.dts': {\n    source: 'iana',\n    extensions: ['dts'],\n  },\n  'audio/vnd.dts.hd': {\n    source: 'iana',\n    extensions: ['dtshd'],\n  },\n  'audio/vnd.lucent.voice': {\n    source: 'iana',\n    extensions: ['lvp'],\n  },\n  'audio/vnd.ms-playready.media.pya': {\n    source: 'iana',\n    extensions: ['pya'],\n  },\n  'audio/vnd.nuera.ecelp4800': {\n    source: 'iana',\n    extensions: ['ecelp4800'],\n  },\n  'audio/vnd.nuera.ecelp7470': {\n    source: 'iana',\n    extensions: ['ecelp7470'],\n  },\n  'audio/vnd.nuera.ecelp9600': {\n    source: 'iana',\n    extensions: ['ecelp9600'],\n  },\n  'audio/vnd.rip': {\n    source: 'iana',\n    extensions: ['rip'],\n  },\n  'audio/wav': {\n    compressible: false,\n    extensions: ['wav'],\n  },\n  'audio/wave': {\n    compressible: false,\n    extensions: ['wav'],\n  },\n  'audio/webm': {\n    source: 'apache',\n    compressible: false,\n    extensions: ['weba'],\n  },\n  'audio/x-aiff': {\n    source: 'apache',\n    extensions: ['aif', 'aiff', 'aifc'],\n  },\n  'audio/x-caf': {\n    source: 'apache',\n    compressible: false,\n    extensions: ['caf'],\n  },\n  'audio/x-flac': {\n    source: 'apache',\n    extensions: ['flac'],\n  },\n  'audio/x-m4a': {\n    source: 'nginx',\n    extensions: ['m4a'],\n  },\n  'audio/x-matroska': {\n    source: 'apache',\n    extensions: ['mka'],\n  },\n  'audio/x-mpegurl': {\n    source: 'apache',\n    extensions: ['m3u'],\n  },\n  'audio/x-ms-wax': {\n    source: 'apache',\n    extensions: ['wax'],\n  },\n  'audio/x-ms-wma': {\n    source: 'apache',\n    extensions: ['wma'],\n  },\n  'audio/x-pn-realaudio': {\n    source: 'apache',\n    extensions: ['ram', 'ra'],\n  },\n  'audio/x-pn-realaudio-plugin': {\n    source: 'apache',\n    extensions: ['rmp'],\n  },\n  'audio/x-realaudio': {\n    source: 'nginx',\n    extensions: ['ra'],\n  },\n  'audio/x-wav': {\n    source: 'apache',\n    extensions: ['wav'],\n  },\n  'audio/xm': {\n    source: 'apache',\n    extensions: ['xm'],\n  },\n  'application/vnd.apple.mpegurl': {\n    source: 'iana',\n    extensions: ['m3u8'],\n  },\n  'audio/x-mpepgurl': {\n    source: 'apache',\n    extensions: ['m3u'],\n  },\n};\n\nconst TYPES = Object.create(null);\nconst EXTENSIONS = Object.create(null);\n\nfunction populateMaps(extensions, types) {\n  // source preference (least -> most)\n  let preference = ['nginx', 'apache', undefined, 'iana'];\n\n  Object.keys(MIME_TYPES).forEach(function (type) {\n    let mime = MIME_TYPES[type];\n    let exts = mime.extensions;\n\n    if (!exts || !exts.length) {\n      return false;\n    }\n\n    // mime -> extensions\n    extensions[type] = exts;\n\n    // extension -> mime\n    for (let i = 0; i < exts.length; i++) {\n      let extension = exts[i];\n\n      if (types[extension]) {\n        let start = preference.indexOf(MIME_TYPES[types[extension]].source);\n        let end = preference.indexOf(mime.source);\n\n        if (\n          (types[extension] !== 'application/octet-stream' && start > end) ||\n          (start === end && types[extension].substr(0, 12) === 'application/')\n        ) {\n          // skip the remapping\n          continue;\n        }\n      }\n\n      // set the extension -> mime\n      types[extension] = type;\n    }\n  });\n}\n\npopulateMaps(EXTENSIONS, TYPES);\n\nexport function getMimeType(url) {\n  if (!url || typeof url !== 'string') {\n    return false;\n  }\n\n  let extension = url\n    .toLowerCase()\n    .split('.')\n    .pop()\n    .split('?')\n    .shift()\n    .split('#')\n    .shift();\n\n  if (!extension) {\n    return false;\n  }\n\n  return TYPES[extension] || false;\n}\n\n\nexport default { getMimeType, TYPES, EXTENSIONS, MIME_TYPES }\n"],"names":["MIME_TYPES","source","extensions","compressible","TYPES","Object","create","EXTENSIONS","populateMaps","types","preference","undefined","keys","forEach","type","mime","exts","length","i","extension","start","indexOf","end","substr","getMimeType","url","toLowerCase","split","pop","shift"],"mappings":"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"}