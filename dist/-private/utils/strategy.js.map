{"version":3,"file":"strategy.js","sources":["../../../src/-private/utils/strategy.js"],"sourcesContent":["import { tracked } from '@glimmer/tracking';\nimport { cached } from 'tracked-toolbox';\nimport { setOwner, getOwner } from '@ember/application';\n\nexport default class Strategy {\n  @tracked stereoUrl;\n  @tracked config;\n\n  sharedAudioAccess = null;\n  error = null;\n  erroredSound = null;\n  success = false;\n  tried = false;\n\n  constructor(connection, stereoUrl, config = {}) {\n    this.connection = connection;\n    // assert('[ember-stereo] strategy constructor requires a StereoUrl', (stereoUrl.url && stereoUrl.mimeType))\n\n    this.stereoUrl = stereoUrl;\n    this.config = config || {};\n    this.sharedAudioAccess = config.sharedAudioAccess;\n  }\n\n  get url() {\n    if (this.stereoUrl) {\n      return this.stereoUrl.url;\n    }\n    return null;\n  }\n\n  get mimeType() {\n    if (this.stereoUrl) {\n      return this.stereoUrl.mimeType;\n    }\n    return null;\n  }\n\n  get name() {\n    return this.connectionName;\n  }\n\n  get connectionName() {\n    return this.connection.toString();\n  }\n\n  get key() {\n    return this.connection.key;\n  }\n\n  get connectionKey() {\n    return this.key;\n  }\n\n  get options() {\n    return this.config.options;\n  }\n\n  @cached\n  get canUseConnection() {\n    if (!this.url) {\n      return false;\n    }\n    return this.connection.canUseConnection(this.url);\n  }\n\n  @cached\n  get canPlayMimeType() {\n    if (!this.url) {\n      return false;\n    }\n    return this.connection.canPlayMimeType(this.mimeType);\n  }\n\n  @cached\n  get canPlay() {\n    if (!this.url) {\n      return false;\n    }\n    return this.connection.canPlay(this.url, this.mimeType);\n  }\n\n  createSound() {\n    let sound = new this.connection({\n      url: this.url,\n      connectionName: this.connectionName,\n      connectionKey: this.connectionKey,\n      sharedAudioAccess: this.sharedAudioAccess,\n      options: this.options,\n    });\n\n    setOwner(sound, getOwner(this));\n    return sound;\n  }\n}\n"],"names":["Strategy","_class","constructor","connection","stereoUrl","config","_initializerDefineProperty","_descriptor","_descriptor2","_defineProperty","sharedAudioAccess","url","mimeType","name","connectionName","toString","key","connectionKey","options","canUseConnection","canPlayMimeType","canPlay","createSound","sound","setOwner","getOwner","_applyDecoratedDescriptor","prototype","tracked","configurable","enumerable","writable","initializer","cached","Object","getOwnPropertyDescriptor"],"mappings":"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"}